function CBmakeHttpRequest(a,b,c,d,e){function f(a){a.readyState==4&&(a.status==200&&a.responseText.length>0&&a.responseText.length<1025?document.getElementById(b).innerHTML=a.responseText:c.length>0?document.getElementById(b).innerHTML=c:document.getElementById(b).innerHTML="",a=null)}if(arguments.length<5||e==null)e=CBgetHttpRequestInstance();if(!e)return!1;e.onreadystatechange=function(){f(e)},d==null?(e.open("GET",a,!0),e.send(null)):(e.open("POST",a,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("Content-length",d.length),e.send(d));return!0}function CBgetHttpRequestInstance(){var a=!1;if(window.XMLHttpRequest)a=new XMLHttpRequest,a.overrideMimeType&&a.overrideMimeType("text/xml");else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}return a}function cbInitFields(){if(cbW3CDOM){typeof overlib_pagedefaults!="undefined"&&overlib_pagedefaults(WIDTH,250,VAUTO,RIGHT,AUTOSTATUSCAP,CSSCLASS,TEXTFONTCLASS,"cb-tips-font",FGCLASS,"cb-tips-fg",BGCLASS,"cb-tips-bg",CAPTIONFONTCLASS,"cb-tips-capfont",CLOSEFONTCLASS,"cb-tips-closefont");if(typeof cbHideFields=="undefined")return;for(var a=0;a<cbHideFields.length;a++){var b=document.getElementById(cbHideFields[a][0]);if(b===null)alert("xml name "+cbHideFields[a][0]+" is undefined. It is cbHideFields["+a+"][0].");else{var c=b.getElementsByTagName("input");c.length==0&&(c=b.getElementsByTagName("select"));var d=1;cbSels[a]=[],cbSels[a][0]=b;for(var e=0;e<c.length;e++)c[e].type!="hidden"&&(c[e].type=="text"?cbAddEvent(c[e],"change",cbParamChange):cbAddEvent(c[e],"click",cbParamChange),cbSels[a][d++]=c[e])}}cbParamChange()}}function cbParamChange(){var a=[],b=[],c,d,e,f,g=!1,h,i,j,k;for(h=0;h<cbHideFields.length;h++){for(i=1;i<cbSels[h].length;i++)cbSels[h][i].type!="hidden"&&(cbSels[h][i].type=="radio"||cbSels[h][i].type=="checkbox"?cbSels[h][i].checked&&(c=cbSels[h][i].value):c=cbSels[h][i].value);var l=!1;switch(cbHideFields[h][2]){case"==":c==cbHideFields[h][3]&&(l=!0);break;case"!=":c!=cbHideFields[h][3]&&(l=!0);break;case">=":c>=cbHideFields[h][3]&&(l=!0);break;case"<=":c<=cbHideFields[h][3]&&(l=!0);break;case">":c>cbHideFields[h][3]&&(l=!0);break;case"<":c<cbHideFields[h][3]&&(l=!0);break;case"regexp":var m=new RegExp(cbHideFields[h][3]);l=!m.test(c);break;case"!regexp":var m=new RegExp(cbHideFields[h][3]);l=m.test(c);break;case"evaluate":break;default:alert('js error operator "'+cbHideFields[h][2]+'" unknown.')}if(cbHideFields[h][2]=="evaluate")typeof cbPreviousOnChangeValues[cbHideFields[h][1]]!="undefined"&&(cbPreviousOnChangeValues[cbHideFields[h][1]]!=c&&(g=!0)),cbPreviousOnChangeValues[cbHideFields[h][1]]=c;else if(l){for(i=0;i<a.length;i++)for(j=0;j<cbHideFields[h][4].length;j++)cbHideFields[h][4][j]==a[i]&&a.splice(i,1);b=b.concat(cbHideFields[h][4]);if(cbHideFields[h][5].length>0)if(cbGetDisplayStyle(document.getElementById(cbHideFields[h][0]))!="none")for(i=0;i<cbHideFields[h][5].length;i++)d=cbHideFields[h][5][i].split("=",3),cbGetDisplayStyle(document.getElementById(cbHideFields[h][4][0]))!="none"&&(e=document.getElementById(d[1]),typeof cbParamsSaveBefHide[h]=="undefined"&&(cbParamsSaveBefHide[h]=[]),cbParamsSaveBefHide[h][i]=e.value,e.value=d[2])}else{k=!1;for(i=0;i<b.length;i++)for(j=0;j<cbHideFields[h][4].length;j++)cbHideFields[h][4][j]==b[i]&&(k=!0);if(!k){a=a.concat(cbHideFields[h][4]);if(cbHideFields[h][5].length>0)for(i=0;i<cbHideFields[h][5].length;i++)d=cbHideFields[h][5][i].split("=",3),cbGetDisplayStyle(document.getElementById(cbHideFields[h][4][0]))=="none"&&(e=document.getElementById(d[1]),e.value=cbParamsSaveBefHide[h][i])}}}if(typeof jQuery=="undefined"){for(h=0;h<a.length;h++)f=document.getElementById(a[h]),f?f.style.display="":alert("field not found number: "+h+" id:"+a[h]);for(h=0;h<b.length;h++)f=document.getElementById(b[h]),f?f.style.display="none":alert("field not found number: "+h+" id:"+b[h])}else if(cbFirstTimeChange){for(h=0;h<a.length;h++)jQuery(document.getElementById(a[h])).show();for(h=0;h<b.length;h++)jQuery(document.getElementById(b[h])).hide()}else{for(h=0;h<a.length;h++)jQuery(document.getElementById(a[h])).fadeIn("slow");for(h=0;h<b.length;h++)jQuery(document.getElementById(b[h])).fadeOut("slow",function(){jQuery(this).hide()})}cbFirstTimeChange=!1;if(g){cbParentForm(this).submit();return!1}}function cbGetDisplayStyle(a){var b;a.style.getPropertyValue?b=a.style.getPropertyValue("display"):b=a.style.display;return b}function cbFilterInputBlur(a){cbParentForm(this).submit();return!1}function cbInitFiltersBlur(){if(cbW3CDOM){var a=cbGetElementsByClass("cbFilters");if(a.length==1&&a[0].getElementsByTagName("input").length==1)for(var b=0;b<a.length;b++)cbAddEventObjArray(a[b].getElementsByTagName("input"),"change",cbFilterInputBlur),cbAddEventObjArray(a[b].getElementsByTagName("select"),"change",cbFilterInputBlur)}}function cbAddEventObjArray(objArr,evType,fn){for(var j=0;j<objArr.length;j++)objArr[j].type!="hidden"&&eval("objArr[j].on"+evType+"=fn")}function cbAddEvent(a,b,c){if(a.addEventListener){a.addEventListener(b,c,!0);return!0}if(a.attachEvent){var d=a.attachEvent("on"+b,c);return d}return!1}function cbGetElementsByClass(a,b,c){var d=[];b==null&&(b=document),c==null&&(c="*");var e=b.getElementsByTagName(c),f=e.length,g=new RegExp("(^|\\s)"+a+"(\\s|$)");for(i=0,j=0;i<f;i++)g.test(e[i].className)&&(d[j]=e[i],j++);return d}function cbsubmitform(a){document.forms.adminForm.elements.task.value=a;if(typeof jQuery!="undefined")jQuery(document.forms.adminForm).submit();else{if(typeof document.forms.adminForm!="undefined")try{document.forms.adminForm.onsubmit()}catch(b){}document.forms.adminForm.submit()}}function submitbutton(a){cbsubmitform(a);return!1}function cbDoListTask(a,b,c,d,e){var f=document.forms.adminForm;if(a){var g=!1;for(i=0;!0;i++){cbx=f.elements[e+i];if(!cbx)break;if(cbx.checked){g=!0;break}}if(g){if(d=="deleterows")if(!confirm("Are you sure you want to delete selected items ?"))return!1;f.elements[c].value=d,submitbutton(b)}else alert("no items selected")}return!1}function cbListItemTask(a,b,c,d,e,f){var g=cbParentForm(a);if(a){for(i=0;!0;i++){cbx=g.elements[e+i];if(!cbx)break;i==f?cbx.checked=!0:cbx.checked=!1}g.elements[c].value=d,submitbutton(b)}return!1}function cbParentForm(a){var b;a==window?b=window.event.srcElement:b=a;while(b){b=b.parentNode;if(b.nodeName=="FORM")break}return b}function cbToggleAll(tgl,n,fldName){fldName||(fldName="cb");var frm=tgl.form;for(i=0;i<n;i++)cb=eval("frm."+fldName+i),cb&&(cb.checked=tgl.checked);return!0}function cbCheckAllRowsAndSubTask(a,b,c,d,e){c||(c="cb"),f=cbParentForm(a);for(var g=0;g<b;g++)box=f.elements[c+g],box.checked==!1&&(box.checked=!0);d&&e&&(f.elements[d].value=e)}function cbsaveorder(a,b,c,d,e,f){cbCheckAllRowsAndSubTask(a,b,c,e,f),submitform(d)}var cbW3CDOM=document.createElement&&document.getElementsByTagName;cbAddEvent(window,"load",cbInitFiltersBlur);var cbHideFields=[],cbParamsSaveBefHide=[],cbSels=[],cbPreviousOnChangeValues=[],cbFirstTimeChange=!0;cbAddEvent(window,"load",cbInitFields)