/* iubito's menu - http://iubito.free.fr/prog/menu.php - configuration du javascript *//* true = le menu sera vertical, ï¿½ gauche.
   false = le menu sera horizontal, en haut. */function bbgetRefByName(a,b){var c=null,d;b=b||document;if(b.images[a])return b.images[a];if(b.anchors[a])return b.anchors[a];if(b.layers&&b.layers.length>0)for(d=0;d<b.layers.length;d++){c=getRefByName(a,b.layers[d].document);if(c&&c.length>0)return c;if(c)return[c,b.layers[d]]}return null}function bbgetRefById(a,b){var c="",d;b=b||document;if(b.all)return b.all[a];if(b.getElementById)return b.getElementById(a);if(b.layers&&b.layers.length>0){if(b.layers[a])return b.layers[a];for(d=0;d<b.layers.length;d++){c=getRefById(a,b.layers[d].document);if(c)return c}}return!1}function bbpageLocation(a,b){var c=0;while(a)c+=a["offset"+b],a=a.offsetParent;return c}function bbgetAnchorLocation(a){var b,c,d,e;b=e=a,d=[cbMenuAnchorOffsetx,cbMenuAnchorOffsety],document.layers?typeof e.length!="undefined"&&e.length>1?(b=e[0],d[0]+=e[0].x+e[1].pageX,d[1]+=e[0].y+e[1].pageY):(e+"").indexOf("Image")!=-1||(e+"").indexOf("Anchor")!=-1?(d[0]+=e.x,d[1]+=e.y):(d[0]+=e.pageX,d[1]+=e.pageY):(d[0]+=bbpageLocation(e,"Left"),d[1]+=bbpageLocation(e,"Top"));return d}function bbgetLocation(a,b){var c,d=bbgetRefById(a,b.document);if(d)c=bbgetAnchorLocation(d);else{alert('WARNING: menu anchor id="'+a+'" not found in html.');return null}return c}function bbsetMenuLocation(a){var b;cbMenuAnchorReference=="1"&&(cbMenuAnchorReference="conteneurmenu"),b=bbgetLocation(cbMenuAnchorReference,a),b&&(top_menu=b[1],left_menu=b[0],top_ssmenu=top_menu+bb_top_menu_to_ssmenu,left_ssmenu=left_menu+largeur_menu+bb_right_menu_to_ssmenu)}function SelectVisible(a,b){if(blnOk&&cacher_les_select&&(isIE||isIE5win))for(var c=0;c<b.length;c++)b[c].style.visibility=a}function trimespaces(){if(blnOk&&isIE5win)for(i=1;i<=nbmenu;i++)if(document.getElementById("ssmenu"+i))with(document.getElementById("ssmenu"+i))innerHTML=innerHTML.replace(/<LI>|<\/LI>/g,"")}function CacherMenus(){if(blnOk)for(i=1;i<=nbmenu;i++)if(document.getElementById("ssmenu"+i))with(document.getElementById("ssmenu"+i).style)visibility="hidden";SelectVisible("visible",document.getElementsByTagName("select"))}function AnnulerCacher(){blnOk&&timeout&&clearTimeout(timeout)}function CacherDelai(){blnOk&&(timeout=setTimeout("CacherMenus()",delai))}function MontrerMenu(strMenu){if(blnOk){AnnulerCacher(),CacherMenus();if(document.getElementById(strMenu))with(document.getElementById(strMenu).style)visibility="visible"}SelectVisible("hidden",document.getElementsByTagName("select"))}function positionne(){var largeur_fenetre=isIE?document.body.clientWidth:window.innerWidth,hauteur_fenetre=isIE?document.body.clientHeight:window.innerHeight;if(centrer_menu)if(vertical){var hauteur_totale=espace_entre_menus*(nbmenu-1);if(isFinite(hauteur_menu))hauteur_totale+=hauteur_menu*nbmenu;else for(i=1;i<=nbmenu;i++)hauteur_totale+=hauteur_menu[i-1];top_menu=(hauteur_fenetre-hauteur_totale)/2}else{var largeur_totale=espace_entre_menus*(nbmenu-1);if(isFinite(largeur_menu))largeur_totale+=largeur_menu*nbmenu;else for(i=1;i<=nbmenu;i++)largeur_totale+=largeur_menu[i-1];left_menu=(largeur_fenetre-largeur_totale)/2}var i,cumul=0;if(cbMenuAnchorReference!=="1")for(i=1;i<=nbmenu;i++)with(document.getElementById("menu"+i).style)vertical?(top=(i-1)*espace_entre_menus+cumul+top_menu+"px",left=left_menu+"px"):(top=top_menu+"px",left=(i-1)*espace_entre_menus+cumul+left_menu+"px"),!suivre_le_scroll||isIE||isIE5mac?position="absolute":position="fixed",margin="0",zIndex="2",vertical||isFinite(largeur_menu)?width=largeur_menu+"px":width=largeur_menu[i-1]+"px",!vertical&&isFinite(largeur_menu)||vertical&&isFinite(hauteur_menu)?cumul+=vertical?hauteur_menu:largeur_menu:(cumul+=vertical?hauteur_menu[i-1]:largeur_menu[i-1],vertical&&(height=hauteur_menu[i-1]+"px"));cumul=0;for(i=1;i<=nbmenu;i++){if(document.getElementById("ssmenu"+i))with(document.getElementById("ssmenu"+i).style)cbMenuAnchorReference!=="1"&&(!suivre_le_scroll||isIE||isIE5mac?position="absolute":position="fixed",vertical?(left=left_ssmenu+"px",top=(i-1)*espace_entre_menus+cumul+1+top_menu+"px"):(top=top_ssmenu+"px",left=(i-1)*espace_entre_menus+cumul+1+left_menu+"px")),isIE5mac||!largeur_auto_ssmenu?isFinite(largeur_sous_menu)?width=largeur_sous_menu+(largeur_sous_menu!="auto"?"px":""):width=largeur_sous_menu[i-1]+(largeur_sous_menu[i-1]!="auto"?"px":""):cbMenuAnchorReference!=="1"&&(width="auto"),cbMenuAnchorReference!=="1"&&(!vertical&&!isIE5mac&&(width!="auto"&&left.replace(reg,"").valueOf()*1+width.replace(reg,"").valueOf()*1>largeur_fenetre&&(left=largeur_fenetre-width.replace(reg,"").valueOf()+"px")),margin="0",zIndex="3");cbMenuAnchorReference!=="1"&&(!vertical&&isFinite(largeur_menu)||vertical&&isFinite(hauteur_menu)?cumul+=vertical?hauteur_menu:largeur_menu:cumul+=vertical?hauteur_menu[i-1]:largeur_menu[i-1])}}function Chargement(){cbMenuAnchorReference!=="1"&&bbsetMenuLocation(document);if(!blnOk){document.body.style.backgroundColor!=""&&(blnOk=!1),document.body.style.color!=""&&(blnOk=!1),document.body.style.marginTop!=""&&(blnOk=!1);if(document.getElementById)with(document.getElementById("conteneurmenu").style)if(position!=""||top!=""||left!=""||width!=""||height!=""||zIndex!=""||margin!=""||visibility!="")blnOk=!1,alert("BB:ko1");else blnOk=!1}if(blnOk){document.getElementById("conteneurmenu").style.visibility="hidden",trimespaces();if(bbAddMarginsToDoc)with(document.body.style)vertical?marginLeft=marge_a_gauche_de_la_page+"px":marginTop=marge_en_haut_de_page+"px";positionne(),CacherMenus()}document.getElementById("conteneurmenu").style.visibility=""}function preChargement(){document.getElementById("conteneurmenu")&&(document.getElementById("conteneurmenu").style.visibility="hidden")}var vertical=!1,nbmenu=3,centrer_menu=!1,largeur_menu=95,hauteur_menu=25,largeur_sous_menu=150,largeur_auto_ssmenu=!0,espace_entre_menus=5,cbMenuAnchorReference="1",cbMenuAnchorOffsetx=0,cbMenuAnchorOffsety=0,top_menu=10,bb_top_menu_to_ssmenu=23,top_ssmenu=top_menu+bb_top_menu_to_ssmenu,left_menu=10,bb_right_menu_to_ssmenu=10,left_ssmenu=left_menu+largeur_menu+bb_right_menu_to_ssmenu,delai=650,bbAddMarginsToDoc=!1,marge_en_haut_de_page=top_menu+40,marge_a_gauche_de_la_page=largeur_menu+10,suivre_le_scroll=!1,cacher_les_select=!0,timeout,agt=navigator.userAgent.toLowerCase(),isMac=agt.indexOf("mac")!=-1,isOpera=agt.indexOf("opera")!=-1,IEver=parseInt(agt.substring(agt.indexOf("msie ")+5),10),isIE=agt.indexOf("msie")!=-1&&!isOpera&&agt.indexOf("webtv")==-1&&!isMac,isIE5win=isIE&&IEver==5,isIE5mac=agt.indexOf("msie")!=-1&&isMac,blnOk=!0,reg=new RegExp("px","g");window.onscroll=function(){if(blnOk&&suivre_le_scroll&&(isIE||isIE5mac)){isIE5mac&&(document.getElementById("conteneurmenu").style.visibility="hidden");var a=0;for(i=1;i<=nbmenu;i++)vertical?(document.getElementById("menu"+i).style.top=document.body.scrollTop+((i-1)*espace_entre_menus+a+1+top_menu)+"px",document.getElementById("ssmenu"+i)&&(document.getElementById("ssmenu"+i).style.top=document.body.scrollTop+((i-1)*espace_entre_menus+a+1+top_menu)+"px"),a+=isFinite(hauteur_menu)?hauteur_menu:hauteur_menu[i-1]):(document.getElementById("menu"+i).style.top=document.body.scrollTop+top_menu+"px",document.getElementById("ssmenu"+i)&&(document.getElementById("ssmenu"+i).style.top=document.body.scrollTop+top_ssmenu+"px"));isIE5mac&&(document.getElementById("conteneurmenu").style.visibility="visible")}},window.onresize=Chargement