/**
 * The main Mapifies object
 * @method
 * @namespace Mapifies
 * @id Mapifies
 * @author Tane Piper <tane@digitalspaghetti.me.uk>
 *
 * BBFIXED $ to jQuery for non-conflict mode
 */var Mapifies;Mapifies||(Mapifies=function(){}),Mapifies.MapObjects={},Mapifies.MapObjects.Set=function(a,b){var c=jQuery(a).attr("id"),d=new GMap2(a);Mapifies.MapObjects[c]=d,Mapifies.MapObjects[c].Options=b;return Mapifies.MapObjects[c]},Mapifies.MapObjects.Append=function(a,b,c){var d=jQuery(a).attr("id");Mapifies.MapObjects[d][b]=c},Mapifies.MapObjects.Get=function(a){return Mapifies.MapObjects[jQuery(a).attr("id")]},Mapifies.Initialise=function(a,b,c){function d(){return{language:"en",mapType:G_NORMAL_MAP,mapCenter:[55.958858,-3.162302],mapZoom:12,mapControl:"small",mapEnableType:!1,mapEnableOverview:!1,mapEnableDragging:!0,mapEnableInfoWindows:!0,mapEnableDoubleClickZoom:!1,mapEnableScrollZoom:!1,mapEnableSmoothZoom:!1,mapEnableGoogleBar:!1,mapEnableScaleControl:!1,mapShowjMapsIcon:!0,debugMode:!1}}b=jQuery.extend(d(),b);if(!GBrowserIsCompatible()){jQuery(a).text("Your browser does not support Google Maps.");return!1}var e=Mapifies.MapObjects.Set(a,b);e.setCenter(new GLatLng(b.mapCenter[0],b.mapCenter[1]),b.mapZoom,b.mapType),b.mapShowjMapsIcon&&Mapifies.AddScreenOverlay(a,{imageUrl:"http://hg.digitalspaghetti.me.uk/jmaps/raw-file/3228fade0b3c/docs/images/jmaps-mapicon.png",screenXY:[70,10],overlayXY:[0,0],size:[42,25]});switch(b.mapControl){case"small":e.addControl(new GSmallMapControl);break;case"large":e.addControl(new GLargeMapControl)}b.mapEnableType&&e.addControl(new GMapTypeControl),b.mapEnableOverview&&e.addControl(new GOverviewMapControl),b.mapEnableDragging||e.disableDragging(),b.mapEnableInfoWindows||e.disableInfoWindow(),b.mapEnableDoubleClickZoom&&e.enableDoubleClickZoom(),b.mapEnableScrollZoom&&e.enableScrollWheelZoom(),b.mapEnableSmoothZoom&&e.enableContinuousZoom(),b.mapEnableGoogleBar&&e.enableGoogleBar(),b.mapEnableScaleControl&&e.addControl(new GScaleControl),b.debugMode&&console.log(Mapifies);if(typeof c=="function")return c(e,a,b);return},Mapifies.MoveTo=function(a,b,c){function d(){return{centerMethod:"normal",mapType:null,mapCenter:[],mapZoom:null}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f=new GLatLng(b.mapCenter[0],b.mapCenter[1]);switch(b.centerMethod){case"normal":e.setCenter(f,b.mapZoom,b.mapType);break;case"pan":e.panTo(f)}if(typeof c=="function")return c(f,b)},Mapifies.SavePosition=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.savePosition();if(typeof c=="function")return c(d)},Mapifies.GotoSavedPosition=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.returnToSavedPosition();if(typeof c=="function")return c(d)},Mapifies.CreateKeyboardHandler=function(a,b,c){var d=Mapifies.MapObjects.Get(a),e=new GKeyboardHandler(d);if(typeof c=="function")return c(e,d)},Mapifies.CheckResize=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.checkResize();if(typeof c=="function")return c(d)},Mapifies.SetMapType=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.setMapType(window[b]);if(typeof c=="function")return c(d)},Mapifies.ClearMap=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.clearOverlays();if(typeof c=="function")return c(d)},Mapifies.SearchAddress=function(a,b,c){function d(){return{query:null,returnType:"getLatLng",cache:undefined,countryCode:"uk"}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);if(typeof e.Geocoder==="undefined"){if(typeof b.cache==="undefined")var f=new GClientGeocoder;else var f=new GClientGeocoder(cache);Mapifies.MapObjects.Append(a,"Geocoder",f),e=Mapifies.MapObjects.Get(a)}e.Geocoder[b.returnType](b.query,function(a){if(typeof c==="function")return c(a,b)});return},Mapifies.SearchDirections=function(a,b,c){function i(){if(typeof c=="function")return c(e.Directions,b)}function h(){if(typeof c=="function")return c(e.Directions,b)}function d(){return{query:null,panel:null,locale:"en_GB",travelMode:"driving",avoidHighways:!1,getPolyline:!0,getSteps:!0,preserveViewport:!1,clearLastSearch:!1}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f={locale:b.locale,travelMode:b.travelMode,avoidHighways:b.avoidHighways,getPolyline:b.getPolyline,getSteps:b.getSteps,preserveViewport:b.preserveViewport},g=jQuery(b.panel).get(0);typeof e.Directions==="undefined"&&Mapifies.MapObjects.Append(a,"Directions",new GDirections(e,g)),GEvent.addListener(e.Directions,"load",h),GEvent.addListener(e.Directions,"error",i),b.clearLastSearch&&e.Directions.clear(),e.Directions.load(b.query,f);return},Mapifies.CreateAdsManager=function(a,b,c){function d(){return{publisherId:"",maxAdsOnMap:3,channel:0,minZoomLevel:6}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f={maxAdsOnMap:b.maxAdsOnMap,channel:b.channel,minZoomLevel:b.minZoomLevel};typeof e.AdsManager=="undefined"&&Mapifies.MapObjects.Append(a,"AdsManager",new GAdsManager(e,b.publisherId,f));if(typeof c=="function")return c(e.AdsManager,b)},Mapifies.AddFeed=function(a,b,c){function d(){return{feedUrl:null,mapCenter:[]}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f=new GGeoXml(b.feedUrl);e.addOverlay(f),b.mapCenter[0]&&b.mapCenter[1]&&e.setCenter(new GLatLng(b.mapCenter[0],b.mapCenter[1]));if(typeof c=="function")return c(f,b);return},Mapifies.RemoveFeed=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.removeOverlay(b);if(typeof c=="function")return c(b);return},Mapifies.AddGroundOverlay=function(a,b,c){function d(){return{overlaySouthWestBounds:undefined,overlayNorthEastBounds:undefined,overlayImage:undefined}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f=new GLatLngBounds(new GLatLng(b.overlaySouthWestBounds[0],b.overlaySouthWestBounds[1]),new GLatLng(b.overlayNorthEastBounds[0],b.overlayNorthEastBounds[1]));groundOverlay=new GGroundOverlay(b.overlayImage,f),e.addOverlay(groundOverlay);if(typeof c=="function")return c(groundOverlay,b);return},Mapifies.RemoveGroundOverlay=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.removeOverlay(b);if(typeof c==="function")return c(b);return},Mapifies.AddMarker=function(a,b,c){function d(){var a={pointTitle:"+info",pointLatLng:undefined,pointHTML:undefined,pointOpenHTMLEvent:"click",pointIsDraggable:!1,pointIsRemovable:!1,pointRemoveEvent:"dblclick",pointMinZoom:4,pointMaxZoom:17,pointIcon:undefined,centerMap:!1,centerMoveMethod:"normal"};return a}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend({},d(),b);var f={};jQuery.extend(f,{title:b.pointTitle}),typeof b.pointIcon=="object"&&jQuery.extend(f,{icon:b.pointIcon}),b.pointIsDraggable&&jQuery.extend(f,{draggable:b.pointIsDraggable});if(b.centerMap)switch(b.centerMoveMethod){case"normal":e.setCenter(new GLatLng(b.pointLatLng[0],b.pointLatLng[1]));break;case"pan":e.panTo(new GLatLng(b.pointLatLng[0],b.pointLatLng[1]))}var g=new GMarker(new GLatLng(b.pointLatLng[0],b.pointLatLng[1]),f);b.pointHTML&&GEvent.addListener(g,b.pointOpenHTMLEvent,function(){g.openInfoWindowHtml(b.pointHTML,{maxContent:b.pointMaxContent,maxTitle:b.pointMaxTitle})}),b.pointIsRemovable&&GEvent.addListener(g,b.pointRemoveEvent,function(){e.removeOverlay(g)}),e.MarkerManager?e.MarkerManager.addMarker(g,b.pointMinZoom,b.pointMaxZoom):e.addOverlay(g);if(typeof c=="function")return c(g,b);return},Mapifies.RemoveMarker=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.removeOverlay(b);if(typeof c==="function")return c(b);return},Mapifies.CreateMarkerManager=function(a,b,c){function d(){return{markerManager:"GMarkerManager",borderPadding:100,maxZoom:17,trackMarkers:!1}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f={borderPadding:b.borderPadding,maxZoom:b.maxZoom,trackMarkers:b.trackMarkers},g=new window[b.markerManager](e,b);Mapifies.MapObjects.Append(a,"MarkerManager",g);if(typeof c=="function")return c(g,b)},Mapifies.AddPolygon=function(a,b,c){function d(){return{polygonPoints:[],polygonStrokeColor:"#000000",polygonStrokeWeight:5,polygonStrokeOpacity:1,polygonFillColor:"#ff0000",polygonFillOpacity:1,mapCenter:undefined,polygonClickable:!0}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f={};b.polygonClickable||(f=jQuery.extend(f,{clickable:!1})),typeof b.mapCenter!=="undefined"&&b.mapCenter[0]&&b.mapCenter[1]&&e.setCenter(new GLatLng(b.mapCenter[0],b.mapCenter[1]));var g=[];jQuery.each(b.polygonPoints,function(a,b){g.push(new GLatLng(b[0],b[1]))});var h=new GPolygon(g,b.polygonStrokeColor,b.polygonStrokeWeight,b.polygonStrokeOpacity,b.polygonFillColor,b.polygonFillOpacity,f);e.addOverlay(h);if(typeof c=="function")return c(h,f,b);return},Mapifies.RemovePolygon=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.removeOverlay(b);if(typeof c==="function")return c(b);return},Mapifies.AddPolyline=function(a,b,c){function d(){return{polylinePoints:[],polylineStrokeColor:"#ff0000",polylineStrokeWidth:10,polylineStrokeOpacity:1,mapCenter:[],polylineGeodesic:!1,polylineClickable:!0}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f={};b.polylineGeodesic&&jQuery.extend(f,{geodesic:!0}),b.polylineClickable||jQuery.extend(f,{clickable:!1}),b.mapCenter[0]&&b.mapCenter[1]&&e.setCenter(new GLatLng(b.mapCenter[0],b.mapCenter[1]));var g=[];jQuery.each(b.polylinePoints,function(a,b){g.push(new GLatLng(b[0],b[1]))});var h=new GPolyline(g,b.polylineStrokeColor,b.polylineStrokeWidth,b.polylineStrokeOpacity,f);e.addOverlay(h);if(typeof c=="function")return c(h,f,b);return},Mapifies.RemovePolyline=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.removeOverlay(b);if(typeof c==="function")return c(b);return},Mapifies.AddScreenOverlay=function(a,b,c){function d(){return{imageUrl:"",screenXY:[],overlayXY:[],size:[]}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f=new GScreenOverlay(b.imageUrl,new GScreenPoint(b.screenXY[0],b.screenXY[1]),new GScreenPoint(b.overlayXY[0],b.overlayXY[1]),new GScreenSize(b.size[0],b.size[1]));e.addOverlay(f);if(typeof c=="function")return c(f,b)},Mapifies.RemoveScreenOverlay=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.removeOverlay(b);if(typeof c==="function")return c(b);return},Mapifies.CreateStreetviewPanorama=function(a,b,c){function d(){return{overideContainer:"",latlng:[40.75271883902363,-73.98262023925781],pov:[]}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f=null;b.overideContainer!==""?f=jQuery(b.overideContainer).get(0):f=jQuery(a).get(0);var g={};b.pov.length>0&&jQuery.extend(g,{pov:new GPov(b.latlng[0],b.latlng[1],b.latlng[2])}),b.latlng.length>0&&jQuery.extend(g,{latlng:new GLatLng(b.latlng[0],b.latlng[1])});var h=new GStreetviewPanorama(f,g);if(typeof c=="function")return c(h,b);return},Mapifies.RemoveStreetviewPanorama=function(a,b,c){var d=Mapifies.MapObjects.Get(a);b.remove();if(typeof c=="function")return c(b);return},Mapifies.AddTrafficInfo=function(a,b,c){function d(){return{mapCenter:[]}}var e=Mapifies.MapObjects.Get(a);b=jQuery.extend(d(),b);var f=new GTrafficOverlay;e.addOverlay(f),b.mapCenter[0]&&b.mapCenter[1]&&e.setCenter(new GLatLng(b.mapCenter[0],b.mapCenter[1]));if(typeof c=="function")return c(f,b)},Mapifies.RemoveTrafficInfo=function(a,b,c){var d=Mapifies.MapObjects.Get(a);d.removeOverlay(b);if(typeof c==="function")return c(b);return},Mapifies.SearchCode=function(a){switch(a){case G_GEO_SUCCESS:return{code:G_GEO_SUCCESS,success:!0,message:"Success"};case G_GEO_UNKNOWN_ADDRESS:return{code:G_GEO_UNKNOWN_ADDRESS,success:!1,message:"No corresponding geographic location could be found for one of the specified addresses. This may be due to the fact that the address is relatively new, or it may be incorrect"};case G_GEO_SERVER_ERROR:return{code:G_GEO_UNKNOWN_ADDRESS,success:!1,message:"A geocoding or directions request could not be successfully processed, yet the exact reason for the failure is not known."};case G_GEO_MISSING_QUERY:return{code:G_GEO_UNKNOWN_ADDRESS,success:!1,message:"The HTTP q parameter was either missing or had no value. For geocoder requests, this means that an empty address was specified as input. For directions requests, this means that no query was specified in the input."};case G_GEO_BAD_KEY:return{code:G_GEO_UNKNOWN_ADDRESS,success:!1,message:"The given key is either invalid or does not match the domain for which it was given."};case G_GEO_BAD_REQUEST:return{code:G_GEO_UNKNOWN_ADDRESS,success:!1,message:"A directions request could not be successfully parsed."};default:return{code:null,success:!1,message:"An unknown error occurred."}}},Mapifies.GetTravelMode=function(a){switch(a){case"driving":a=G_TRAVEL_MODE_DRIVING;break;case"walking":a=G_TRAVEL_MODE_WALKING}return a},Mapifies.createIcon=function(a){function b(){return{iconImage:undefined,iconShadow:undefined,iconSize:undefined,iconShadowSize:undefined,iconAnchor:undefined,iconInfoWindowAnchor:undefined,iconPrintImage:undefined,iconMozPrintImage:undefined,iconPrintShadow:undefined,iconTransparent:undefined}}a=jQuery.extend(b(),a);var c=new GIcon(G_DEFAULT_ICON);a.iconImage&&(c.image=a.iconImage),a.iconShadow&&(c.shadow=a.iconShadow),a.iconSize&&(c.iconSize=a.iconSize),a.iconShadowSize&&(c.shadowSize=a.iconShadowSize),a.iconAnchor&&(c.iconAnchor=a.iconAnchor),a.iconInfoWindowAnchor&&(c.infoWindowAnchor=a.iconInfoWindowAnchor);return c},Mapifies.getCenter=function(a){var b=Mapifies.MapObjects.Get(a);return b.getCenter()},Mapifies.getBounds=function(a){var b=Mapifies.MapObjects.Get(a);return b.getBounds()};var Mapifies;Mapifies||(Mapifies={}),function(a){a.fn.jmap=function(a,b,c){return this.each(function(){if(a=="init"&&typeof b=="undefined")new Mapifies.Initialise(this,{},null);else if(a=="init"&&typeof b=="object")new Mapifies.Initialise(this,b,c);else if(a=="init"&&typeof b=="function")new Mapifies.Initialise(this,{},b);else if(typeof a=="object"||a==null)new Mapifies.Initialise(this,a,b);else try{new Mapifies[a](this,b,c)}catch(d){throw Error("Mapifies Function Does Not Exist")}})}}(jQuery)